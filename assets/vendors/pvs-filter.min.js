(function(f){typeof define=="function"&&define.amd?define(f):f()})(function(){"use strict";const f=new Map;function v(e,a,r){return f.set(`${e}:${a}`,r)}function A(e,a){return f.get(`${e}:${a}`)}function S(e){return e.replace(/#.*/,"")}async function q(e,a=!0,r={}){const i=S(e);if(a){const n=A("ajax",i);if(n)return n}const l=await fetch(i,r);if(!l.ok)throw l.status;const g=await l.text();return v("ajax",i,g),g}function E(e){return new DOMParser().parseFromString(e,"text/html")}function p(e){const a=document.createElement("script");Array.from(e.attributes).forEach(r=>a.setAttribute(r.name,r.value)),e.innerHTML&&(a.innerHTML=e.innerHTML),e.replaceWith(a)}let h;function w(){return h||(h=new MutationObserver(e=>{e.forEach(a=>{if(a.type==="childList"&&a.addedNodes.length)for(let r=a.addedNodes.length-1;r>=0;r--){const i=a.addedNodes[r];if(i.nodeType===Node.ELEMENT_NODE&&i.nodeName==="SPAN"&&i.parentElement===document.body&&i.attributes.length===0&&/^\d+(?:\s+\S+)*$/.test(i.textContent.trim())){i.remove();break}}})}),h.observe(document.body,{childList:!0,subtree:!1}),h)}function x(){const e=document.head.getElementsByTagName("style");for(const a of e)if(a.textContent.trim().startsWith(".gh-portal-account-header{display:flex;flex-direction:column;align-items:center;margin:0 0 32px")){a.remove();break}}function N(e){const a=e.querySelectorAll("script");if(a&&a.forEach(r=>{p(r)}),e.querySelector("[data-ghost-search]")){document.querySelectorAll("#sodo-search-root").forEach(i=>i.remove());const r=document.querySelector('script[src*="sodo-search"]');r&&p(r)}if(e.querySelector(".kg-video-card, .kg-audio-card, .kg-toggle-card, .kg-gallery-image")){const r=document.querySelector('script[src*="cards"]');r&&p(r)}if(e.querySelector('[data-lexical-signup-form], [data-members-form], [data-portal], [href*="#/portal"]')){const r=document.querySelector('script[src*="ghost/portal"]');r&&(document.querySelectorAll("#ghost-portal-root").forEach(i=>i.remove()),x(),p(r))}if(e.querySelector("[data-ghost-comment-count]")){const r=document.querySelector('script[src*="comment-counts"]');r&&(w(),p(r))}}const b=window.pvs,{on:y,trigger:L}=window.ivent,M=()=>{const e=new Map;async function a(n,t){try{const o=await q(n);return E(o).querySelector(t)}catch(o){throw new Error(o)}}function r(n){const t=n.parentNode;return{paginationNext:t.querySelector("[data-pagination-append]"),paginationPrev:t.querySelector("[data-pagination-prepend]")}}function i(n,t){const{paginationNext:o,paginationPrev:c}=r(t);n.newList=t.cloneNode(!0),n.dataNext=!!o&&{href:o.getAttribute("href"),from:o.getAttribute("data-pagination-from")||o.getAttribute("data-pagination-append")},n.dataPrev=!!c&&{href:c.getAttribute("href"),from:c.getAttribute("data-pagination-from")||c.getAttribute("data-pagination-append")}}function l(n,t){n&&t?(t.href?(n.classList.remove("complete"),n.setAttribute("href",t.href),t.from&&n.setAttribute("data-pagination-from",t.from)):n.removeAttribute("href"),n.style.display=""):n&&!t&&(n.style.display="none")}function g(n,t){const{newList:o,dataNext:c,dataPrev:m}=t;n.forEach(s=>{s.innerHTML=o.innerHTML,s.classList.remove("loading"),N(s);const{paginationNext:u,paginationPrev:d}=r(s);l(u,c),l(d,m)}),L(document,"pvs.filter.rendered")}y(document,"focus","[data-filter]",n=>{const t=n.delegateTarget,{value:o}=t;if(e.has(t))return;e.set(t,{});const c=e.get(t);if(!c[o]){c[o]={};const m=t.getAttribute("data-filter-append");i(c[o],document.querySelector(m))}}),y(document,"change","[data-filter]",n=>{const t=n.delegateTarget,{value:o}=t,c=t.getAttribute("data-filter-append"),m=t.getAttribute("data-filter-from")||c,s=document.querySelectorAll(c);e.has(t)||e.set(t,{}),document.querySelectorAll("[data-filter]").forEach(d=>{d.getAttribute("data-filter-append")===c&&(d.value=o)});const u=e.get(t);if(u[o]){g(s,u[o]);return}s.forEach(d=>d.classList.add("loading")),a(o,m).then(d=>{u[o]={},i(u[o],d),g(s,u[o])})}),y(document,"pvs.pagination.rendered",()=>{e.forEach((n,t)=>{const o=t.getAttribute("data-filter-append");i(n[t.value],document.querySelector(o))})})};b&&(b.initFilter=M)});
